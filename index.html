<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Museum ArQuest - –ö–≤–µ—Å—Ç –ø–æ –º—É–∑–µ—é</title>
    
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- –ó–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —ç–∫—Ä–∞–Ω -->
    <div id="loader" class="loader-screen">
        <div class="loader-content">
            <div class="museum-logo">
                <img class="logo" src="./assets/logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø –º—É–∑–µ—è">
            </div>
            <h1>–ò—Å—Ç–æ—Ä–∏—è –≤ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–µ</h1>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ AR-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞...</p>
        </div>
    </div>

    <!-- –ü—Ä–æ–ª–æ–≥ -->
    <div id="prologue" class="prologue-screen hidden">
        <div class="princess-hologram">
            <div class="hologram-ring"></div>
            <div class="hologram-avatar">üë∏</div>
        </div>
        
        <div class="dialogue-box">
            <h2>–ú—É–∑–µ–π–∫–∞</h2>
            <p id="prologue-text">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –î–æ–±—Ä—É—à—Å–∫–∏–π —Ä–∞–π–æ–Ω–Ω—ã–π –∫—Ä–∞–µ–≤–µ–¥—á–µ—Å–∫–∏–π –º—É–∑–µ–π. –¢—ã –≥–æ—Ç–æ–≤ –ø—Ä–æ–π—Ç–∏ –∫–≤–µ—Å—Ç? –ï—Å–ª–∏ –¥–∞, —Ç–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –∏ –¥–∞–π —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ.</p>
            <button class="btn-primary" onclick="startFirstQuest()">–ù–∞—á–∞—Ç—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ</button>
            <button class="btn-primary next-quest-btn" onclick="startFinalQuest()" style="margin-top: 10px; background: linear-gradient(135deg, #8b4513 0%, #d2691e 100%);">
                üì∏ –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–µ–ª—Ñ–∏ —Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏
            </button>
        </div>
    </div>

    <!-- AR —Å—Ü–µ–Ω–∞ –¥–ª—è –ø–µ—Ä–≤–æ–π –º–µ—Ç–∫–∏ (—à–∫–æ–ª–∞) -->
    <div id="ar-scene-school" class="ar-container hidden">
        <a-scene mindar-image="imageTargetSrc: ./assets/targets.mind; autoStart: false;" 
                 color-space="sRGB" 
                 renderer="colorManagement: true, physicallyCorrectLights" 
                 vr-mode-ui="enabled: false" 
                 device-orientation-permission-ui="enabled: false">
            <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
            <a-entity id="school-target" mindar-image-target="targetIndex: 0"></a-entity>
        </a-scene>
        <div class="scan-hint">–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –æ—Å–Ω–æ–≤–∞—Ç–µ–ª—å–Ω–∏—Ü—É —à–∫–æ–ª—ã –¥–ª—è –¥–µ—Ç–µ–π —Ä–∞–±–æ—á–∏—Ö —Ñ–∞–±—Ä–∏–∫–∏</div>
    </div>

    <!-- AR —Å—Ü–µ–Ω–∞ –¥–ª—è –≤—Ç–æ—Ä–æ–π –º–µ—Ç–∫–∏ (–≤–∞–∑–∞) -->
    <div id="ar-scene-vase" class="ar-container hidden">
        <a-scene mindar-image="imageTargetSrc: ./assets/targets.mind; autoStart: false;" 
                 color-space="sRGB" 
                 renderer="colorManagement: true, physicallyCorrectLights" 
                 vr-mode-ui="enabled: false" 
                 device-orientation-permission-ui="enabled: false">
            <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
            <a-entity id="vase-target" mindar-image-target="targetIndex: 1"></a-entity>
        </a-scene>
        <div class="scan-hint">–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ —á–µ—Ä–µ–ø–∫–∏ –≤–∞–∑—ã</div>
    </div>
    
    <!-- AR —Å—Ü–µ–Ω–∞ –¥–ª—è —Ç—Ä–µ—Ç—å–µ–π –º–µ—Ç–∫–∏ (–æ—Ä–Ω–∞–º–µ–Ω—Ç) -->
    <div id="ar-scene-ornament" class="ar-container hidden">
        <a-scene mindar-image="imageTargetSrc: ./assets/targets.mind; autoStart: false;" 
                 color-space="sRGB" 
                 renderer="colorManagement: true, physicallyCorrectLights" 
                 vr-mode-ui="enabled: false" 
                 device-orientation-permission-ui="enabled: false">
            <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
            <a-entity id="ornament-target" mindar-image-target="targetIndex: 2"></a-entity>
        </a-scene>
        <div class="scan-hint">–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –æ—Ä–Ω–∞–º–µ–Ω—Ç</div>
    </div>
    
    <!-- AR —Å—Ü–µ–Ω–∞ –¥–ª—è —á–µ—Ç–≤–µ—Ä—Ç–æ–π –º–µ—Ç–∫–∏ (—à–∏—Ñ—Ä) -->
    <div id="ar-scene-cipher" class="ar-container hidden">
        <a-scene mindar-image="imageTargetSrc: ./assets/targets.mind; autoStart: false;" 
                 color-space="sRGB" 
                 renderer="colorManagement: true, physicallyCorrectLights" 
                 vr-mode-ui="enabled: false" 
                 device-orientation-permission-ui="enabled: false">
            <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
            <a-entity id="cipher-target" mindar-image-target="targetIndex: 3"></a-entity>
        </a-scene>
        <div class="scan-hint">–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –¥—Ä–µ–≤–Ω–∏–π —Å–≤–∏—Ç–æ–∫ —Å —à–∏—Ñ—Ä–æ–º</div>
    </div>

    <!-- AR –∫–æ–Ω—Ç–µ–Ω—Ç —à–∫–æ–ª—ã -->
    <div id="ar-content-school" class="hidden">
        <div class="ar-content-wrapper">
            <button class="close-btn" onclick="closeSchoolContent()">‚úï</button>
            
            <div class="ar-content-header">
                <h2>üéØ –ú–µ—Ç–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞!</h2>
                <p class="subtitle">–î–æ–±—Ä—É—à—Å–∫–∞—è —à–∫–æ–ª–∞, 1909 –≥–æ–¥</p>
            </div>
            
            <div class="ar-content-body">
                <div class="content-image">
                    <img src="assets/museum.jpg" alt="–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ç–æ">
                    <div class="image-caption">–ó–¥–∞–Ω–∏–µ —à–∫–æ–ª—ã –≤ –Ω–∞—à–∏ –¥–Ω–∏</div>
                </div>
                
                <div class="content-text">
                    <h3>–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞</h3>
                    <p>–®–∫–æ–ª–∞ –±—ã–ª–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –≤ 1909 –≥–æ–¥—É –ø–æ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–µ –∫–Ω—è–≥–∏–Ω–∏ –ò—Ä–∏–Ω—ã –ü–∞—Å–∫–µ–≤–∏—á. –ó–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤ —Å—Ç–∏–ª–µ –º–æ–¥–µ—Ä–Ω —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –Ω–µ–æ–≥–æ—Ç–∏–∫–∏...</p>
                    
                    <div class="facts">
                        <div class="fact-item"><span class="fact-icon">üèõÔ∏è</span><span>–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä: –ò–≤–∞–Ω –°–µ–º—ë–Ω–æ–≤</span></div>
                        <div class="fact-item"><span class="fact-icon">üë•</span><span>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: 200 —É—á–µ–Ω–∏–∫–æ–≤</span></div>
                        <div class="fact-item"><span class="fact-icon">üìö</span><span>–ü–µ—Ä–≤—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã: —á—Ç–µ–Ω–∏–µ, –ø–∏—Å—å–º–æ, –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞</span></div>
                    </div>
                    
                    <div class="quest-buttons">
                        <button class="btn-primary next-quest-btn" onclick="startVaseQuest()">üè∫ –ù–∞–π—Ç–∏ –¥—Ä–µ–≤–Ω—é—é –≤–∞–∑—É</button>
                        <button class="btn-primary next-quest-btn" onclick="startOrnamentQuest()" style="margin-top: 10px; background: linear-gradient(135deg, #8b0000 0%, #cc3333 100%);">üé® –ë–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –æ—Ä–Ω–∞–º–µ–Ω—Ç</button>
                        <button class="btn-primary next-quest-btn" onclick="startCipherQuest()" style="margin-top: 10px; background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);">üîê –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–∞–Ω–∏–µ</button>
                        <button class="btn-primary next-quest-btn" onclick="startFinalQuest()" style="margin-top: 20px; background: linear-gradient(135deg, #ffd700 0%, #ff9900 100%); color: #2c3e50; font-weight: bold;">üèÜ –§–ò–ù–ê–õ: –ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π —Å–∞–ª—é—Ç</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –∏–≥—Ä—ã —Å –≤–∞–∑–æ–π -->
    <div id="game-screen" class="game-screen hidden">
        <div class="game-header">
            <h1>–†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏—è –¥—Ä–µ–≤–Ω–µ—Å–ª–∞–≤—è–Ω—Å–∫–æ–π –≤–∞–∑—ã</h1>
            <p class="game-subtitle">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –∫–µ—Ä–∞–º–∏–∫–∏ –Ω–∞ –∫–æ–Ω—Ç—É—Ä –≤–∞–∑—ã</p>
        </div>

        <div class="game-container">
            <div class="game-panel fragments-panel">
                <h2 class="panel-title">üè∫ –§—Ä–∞–≥–º–µ–Ω—Ç—ã</h2>
                <div class="fragments-area" id="fragmentsArea"></div>
                <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
                <p class="fragments-count">–°–æ–±—Ä–∞–Ω–æ: <span id="piecesCount">0</span> / <span id="totalPieces">12</span></p>
            </div>

            <div class="game-panel vase-panel">
                <h2 class="panel-title">üéØ –†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏—è</h2>
                <div class="vase-area" id="vaseArea">
                    <img id="vaseImage" src="./assets/vaza.jpg" alt="Vase outline">
                </div>
                <div class="vase-info">
                    <div class="vase-name">–°–ª–∞–≤—è–Ω—Å–∫–∞—è –∫–µ—Ä–∞–º–∏—á–µ—Å–∫–∞—è —É—Ä–Ω–∞ X –≤–µ–∫–∞</div>
                    <div class="vase-desc">–ì–ª–∏–Ω—è–Ω–∞—è —É—Ä–Ω–∞ —Å –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–º –æ—Ä–Ω–∞–º–µ–Ω—Ç–æ–º</div>
                </div>
            </div>
        </div>

        <div class="game-controls">
            <button class="game-btn" onclick="restartGame()">üîÑ –ó–∞–Ω–æ–≤–æ</button>
            <button class="game-btn" onclick="backToMuseum()">üèõÔ∏è –í –º—É–∑–µ–π</button>
        </div>

        <div class="stats-bar">
            <div class="stat"><span class="stat-value" id="placedCount">0</span><span class="stat-label">–°–æ–±—Ä–∞–Ω–æ</span></div>
            <div class="stat"><span class="stat-value" id="timer">00:00</span><span class="stat-label">–í—Ä–µ–º—è</span></div>
            <div class="stat"><span class="stat-value" id="accuracy">0%</span><span class="stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</span></div>
        </div>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–µ (–≤–∞–∑–∞) -->
    <div class="win-message" id="winMessage">
        <h2>üèÜ –í–∞–∑–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!</h2>
        <p>–í—ã —É—Å–ø–µ—à–Ω–æ —Å–æ–±—Ä–∞–ª–∏ –¥—Ä–µ–≤–Ω–µ—Å–ª–∞–≤—è–Ω—Å–∫—É—é –≤–∞–∑—É!</p>
        <p>–í—Ä–µ–º—è: <span id="finalTime">00:00</span></p>
        <div class="win-buttons">
            <button class="game-btn" onclick="restartGame()">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
            <button class="game-btn" onclick="backToMuseum()">–í –º—É–∑–µ–π</button>
            <button class="game-btn" onclick="startFinalQuest()" style="background: linear-gradient(135deg, #ffd700, #ff9900); color: #2c3e50;">üéâ –ö —Ñ–∏–Ω–∞–ª—É</button>
        </div>
    </div>
    
    <!-- –≠–∫—Ä–∞–Ω –∏–≥—Ä—ã —Å –æ—Ä–Ω–∞–º–µ–Ω—Ç–æ–º -->
    <div id="ornament-game-screen" class="ornament-game-screen hidden">
        <div class="ornament-game-header">
            <h1>–ë–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –æ—Ä–Ω–∞–º–µ–Ω—Ç</h1>
            <p class="ornament-game-subtitle">–ó–∞–∫—Ä–∞—Å—å—Ç–µ –∫–≤–∞–¥—Ä–∞—Ç—ã, —á—Ç–æ–±—ã –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —É–∑–æ—Ä</p>
        </div>
        
        <div class="ornament-game-container">
            <div class="ornament-pattern-section">
                <h2 class="ornament-section-title">–û–±—Ä–∞–∑–µ—Ü</h2>
                <div class="ornament-pattern-image-container">
                    <img id="ornamentPatternImage" class="ornament-pattern-image" src="./assets/orname.jpg" alt="–ë–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –æ—Ä–Ω–∞–º–µ–Ω—Ç">
                </div>
                <p class="ornament-pattern-caption">–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π —É–∑–æ—Ä</p>
            </div>
            
            <div class="ornament-draw-section">
                <h2 class="ornament-section-title">–í–∞—à –æ—Ä–Ω–∞–º–µ–Ω—Ç</h2>
                <div class="ornament-canvas-wrapper">
                    <canvas id="ornamentGameCanvas"></canvas>
                </div>
                
                <div class="ornament-tool-info">
                    <div class="ornament-tool-color"></div>
                    <span>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–≤–∞–¥—Ä–∞—Ç</span>
                </div>
                
                <div class="ornament-hint-info">
                    –ó–∞–∫—Ä–∞—Å—å—Ç–µ –∫—Ä–∞—Å–Ω—ã–µ –∫–≤–∞–¥—Ä–∞—Ç—ã, –∫–∞–∫ –Ω–∞ –æ–±—Ä–∞–∑—Ü–µ
                </div>
                
                <div class="ornament-controls">
                    <button id="ornamentClearBtn" class="ornament-btn ornament-btn-clear">–û—á–∏—Å—Ç–∏—Ç—å</button>
                    <button id="ornamentCheckBtn" class="ornament-btn ornament-btn-check">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    <button id="ornamentHintBtn" class="ornament-btn ornament-btn-hint">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                    <button id="ornamentBackBtn" class="ornament-btn ornament-btn-back">–í –º—É–∑–µ–π</button>
                </div>
                
                <div class="ornament-status-bar">
                    <div class="ornament-status-item"><span class="ornament-status-label">–ó–∞–∫—Ä–∞—à–µ–Ω–æ</span><span id="ornamentFilledCount" class="ornament-status-value">0</span></div>
                    <div class="ornament-status-item"><span class="ornament-status-label">–ù—É–∂–Ω–æ</span><span id="ornamentTotalCount" class="ornament-status-value">64</span></div>
                    <div class="ornament-status-item"><span class="ornament-status-label">–°—Ç–∞—Ç—É—Å</span><span id="ornamentStatusDisplay" class="ornament-status-value">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</span></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–µ (–æ—Ä–Ω–∞–º–µ–Ω—Ç) -->
    <div id="ornamentResultMessage" class="ornament-result-message">
        <div class="ornament-result-content">
            <div class="ornament-result-title">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</div>
            <div class="ornament-result-details" id="ornamentResultDetails">–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏–ª–∏ –æ—Ä–Ω–∞–º–µ–Ω—Ç!</div>
            <div class="ornament-result-buttons">
                <button id="ornamentRestartBtn" class="ornament-btn ornament-btn-success">–ó–∞–Ω–æ–≤–æ</button>
                <button id="ornamentBackFromWinBtn" class="ornament-btn ornament-btn-back">–í –º—É–∑–µ–π</button>
                <button onclick="startFinalQuest()" class="ornament-btn" style="background: linear-gradient(135deg, #ffd700, #ff9900); color: #2c3e50;">üéâ –§–ò–ù–ê–õ</button>
            </div>
        </div>
    </div>
    
    <!-- –≠–∫—Ä–∞–Ω –∏–≥—Ä—ã —Å —à–∏—Ñ—Ä–æ–º -->
    <div id="cipher-game-screen" class="cipher-game-screen hidden">
        <div class="cipher-game-header">
            <h1>üîê –†–∞—Å—à–∏—Ñ—Ä—É–π –ø–æ—Å–ª–∞–Ω–∏–µ</h1>
            <p class="cipher-game-subtitle">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á, —á—Ç–æ–±—ã —Ä–∞–∑–≥–∞–¥–∞—Ç—å —Ç–∞–π–Ω—É</p>
        </div>
        
        <div class="cipher-game-container">
            <div class="cipher-info-panel">
                <div class="cipher-scroll">
                    <div class="cipher-scroll-icon">üìú</div>
                    <h3>–î—Ä–µ–≤–Ω–∏–π —Å–≤–∏—Ç–æ–∫</h3>
                    <div class="cipher-encoded" id="cipherEncoded"></div>
                    <div class="cipher-hint"><span class="cipher-hint-icon">üí°</span><span id="cipherHint">–ö–∞–∂–¥–∞—è —Ü–∏—Ñ—Ä–∞ = –±—É–∫–≤–∞</span></div>
                </div>
                
                <div class="cipher-key">
                    <h3>üîë –ö–ª—é—á</h3>
                    <div class="cipher-key-grid" id="cipherKey"></div>
                </div>
            </div>
            
            <div class="cipher-input-panel">
                <h3>‚úçÔ∏è –í–∞—à –æ—Ç–≤–µ—Ç</h3>
                <input type="text" id="cipherUserInput" class="cipher-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ñ—Ä–∞–∑—É..." maxlength="50">
                
                <div class="cipher-letters" id="cipherLetters"></div>
                
                <div class="cipher-controls">
                    <button id="cipherCheckBtn" class="cipher-btn cipher-btn-check">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    <button id="cipherClearBtn" class="cipher-btn cipher-btn-clear">–û—á–∏—Å—Ç–∏—Ç—å</button>
                    <button id="cipherHintBtn" class="cipher-btn cipher-btn-hint">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                    <button id="cipherBackBtn" class="cipher-btn cipher-btn-back">–í –º—É–∑–µ–π</button>
                </div>
                
                <div class="cipher-progress">
                    <div class="cipher-progress-text"><span>–ü—Ä–æ–≥—Ä–µ—Å—Å: <span id="cipherProgress">0/0</span></span></div>
                    <div class="cipher-progress-bar"><div class="cipher-progress-fill" id="cipherProgressFill"></div></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–µ (—à–∏—Ñ—Ä) -->
    <div id="cipherResultMessage" class="cipher-result-message">
        <div class="cipher-result-content">
            <div class="cipher-result-title">üéâ –¢–∞–π–Ω–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∞!</div>
            <div class="cipher-result-details" id="cipherResultDetails">–í—ã —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–ª–∏ –ø–æ—Å–ª–∞–Ω–∏–µ!</div>
            <div class="cipher-result-phrase" id="cipherResultPhrase"></div>
            <div class="cipher-result-buttons">
                <button id="cipherRestartBtn" class="cipher-btn cipher-btn-success">–ù–æ–≤–æ–µ</button>
                <button id="cipherBackFromWinBtn" class="cipher-btn cipher-btn-back">–í –º—É–∑–µ–π</button>
                <button onclick="startFinalQuest()" class="cipher-btn" style="background: linear-gradient(135deg, #ffd700, #ff9900); color: #2c3e50;">üéÜ –§–ò–ù–ê–õ</button>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–µ–ª—Ñ–∏ -->
    <div id="final-game-screen" class="final-game-screen hidden">
        <div class="final-game-header">
            <h1>üéâ –§–ò–ù–ê–õ–¨–ù–´–ô –°–ê–õ–Æ–¢! üéâ</h1>
            <p class="final-game-subtitle">–í—ã –ø—Ä–æ—à–ª–∏ –≤—Å–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è! –°–¥–µ–ª–∞–π—Ç–µ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω–æ–µ —Å–µ–ª—Ñ–∏!</p>
        </div>
        
        <div class="final-game-container">
            <div class="final-celebration">
                <div class="final-trophy">üèÜ</div>
                <h2>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, –≥–µ—Ä–æ–π!</h2>
                <p>–í—ã –∑–∞—Å–ª—É–∂–∏–ª–∏ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π —Å–∞–ª—é—Ç!</p>
            </div>
            
            <div class="final-selfie-preview" id="finalSelfiePreview">
                <video id="finalSelfieVideo" autoplay playsinline muted></video>
                <div class="final-selfie-overlay">
                    <div class="final-selfie-frame">
                        <div class="final-selfie-text">–°–∫–∞–∂–∏ "–°–´–†"!</div>
                    </div>
                </div>
            </div>
            
            <div class="final-controls">
                <button class="final-btn final-btn-primary" onclick="startFaceARSelfie()">üéÜ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∞–ª—é—Ç</button>
                <button class="final-btn final-btn-capture" onclick="captureCelebrationSelfie()">üì∏ –°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ</button>
                <button class="final-btn final-btn-back" onclick="backFromFinal()">üèõÔ∏è –í –º—É–∑–µ–π</button>
            </div>
            
            <div class="final-selfie-gallery" id="finalSelfieGallery">
                <h3>üéä –í–∞—à–∏ —Ñ–æ—Ç–æ</h3>
                <div class="final-gallery-images" id="finalSelfieGalleryImages"></div>
                <button class="final-btn final-btn-clear" onclick="clearSelfieGallery()">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- AR —Å—Ü–µ–Ω–∞ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–µ–ª—Ñ–∏ —Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º –ª–∏—Ü–∞ -->
    <div id="ar-scene-face" class="ar-container hidden">
        <video id="faceDetectionVideo" autoplay playsinline muted style="display: none;"></video>
        
        <div class="face-video-container">
            <video id="faceDisplayVideo" autoplay playsinline muted></video>
            <canvas id="faceEffectsCanvas"></canvas>
            
            <div id="faceARContent" class="face-ar-content">
                <div id="museumLogoFloat" class="museum-logo-float">
                    <div class="museum-logo-text">üèõÔ∏è –î–û–ë–†–£–®–°–ö–ò–ô –ú–£–ó–ï–ô</div>
                </div>
                
                <div id="fireworksContainer" class="fireworks-container">
                    <div class="firework-star star1">‚≠ê</div>
                    <div class="firework-star star2">‚ú®</div>
                    <div class="firework-star star3">üí´</div>
                    <div class="firework-star star4">üåü</div>
                    <div class="firework-star star5">üéÜ</div>
                </div>
                
                <canvas id="confettiCanvas"></canvas>
            </div>
        </div>
        
        <div class="face-scan-hint" id="faceScanHint">
            <div class="hint-text">üòä –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –∫–∞–º–µ—Ä—É</div>
            <div class="hint-subtext">–î–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü–∞...</div>
        </div>
        
        <div class="face-detection-progress" id="faceDetectionProgress">
            <div class="progress-bar-face" id="faceProgressBar"></div>
        </div>
        
        <div class="face-controls" id="faceControls" style="display: none;">
            <button class="face-btn face-btn-firework" onclick="toggleFireworks()">üéÜ –í–∫–ª/–í—ã–∫–ª —Å–∞–ª—é—Ç</button>
            <button class="face-btn face-btn-capture" onclick="takeFacePhotoWithEffects()">üì∏ –°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ</button>
            <button class="face-btn face-btn-close" onclick="closeFaceAR()">‚úï –ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
        </div>
        
        <div class="face-counter" id="faceCounter">üë§ 0 –ª–∏—Ü</div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
    <script src="app.js"></script>
</body>
</html>